<html>
  <head>
    <title>Raycasting Demo</title>
    <link rel="stylesheet" href="./style.css">
  </head>
  <body>

    <input id="chatbox" />
    <div style="display:none;">
      <img id="walls" src="./resources/walls.png" />
      <img id="tallwall" src="./resources/tallwall.png" />
      <img id="tallwall2" src="./resources/tallwall2.png" />
      <img id="tallwallindoor" src="./resources/tallwallindoor.png" />
      <img id="talldoor" src="./resources/talldoor.png" />
      <img id="billboards" src="./resources/billboards.png" />
      <img id="floors" src="./resources/floors.png" />
      <img id="skybox" src="./resources/skybox.png" />
      <img id="player" src="./resources/player.png" />
      <img id="playerback" src="./resources/playerback.png" />
      <img id="weapon" src="./resources/weapon.png" />
      <img id="bush" src="./resources/bush.png" />
      <img id="barrell" src="./resources/barrell.png" />
      <img id="water" src="./resources/water.png" />
      <img id="wateredge" src="resources/wateredge.png" />
      <img id="stonewall" src="resources/stonewall.png" />
      <img id="wood" src="./resources/wood.png" />
      <img id="weapon2" src="./resources/weapon2.png" />
      <img id="arrow" src="./resources/arrow.png" />

      <img id="player1" src="./resources/player1.png" />
      <img id="playerback1" src="./resources/playerback1.png" />
      <img id="player2" src="./resources/player2.png" />
      <img id="playerback2" src="./resources/playerback2.png" />
      <img id="player3" src="./resources/player3.png" />
      <img id="playerback3" src="./resources/playerback3.png" />
      <img id="player4" src="./resources/player4.png" />
      <img id="playerback4" src="./resources/playerback4.png" />
      <img id="player5" src="./resources/player5.png" />
      <img id="playerback5" src="./resources/playerback5.png" />
      <img id="player6" src="./resources/player6.png" />
      <img id="playerback6" src="./resources/playerback6.png" />

      <img id="boss" src="./resources/boss.png" />
      <img id="fireball" src="./resources/fireball.png" />
    </div>
    <table>
      <tr>
        <td>
          <canvas id="scene"></canvas>
        </td>
        <td id="disctd">
          <ul id="discussion" disabled></ul>
        </td>
      </tr>
    </table>
  </body>
</html>
<script src="Main.js"></script>
<script src="Camera.js"></script>
<script src="Level.js"></script>
<script src="RayCaster.js"></script>
<script src="signalr.js"></script>
<script src="connection.js"></script>
<script>
  var cvs = document.getElementById("scene");
  var main;

  window.onload = function() {
    cvs.width = 160;
    cvs.height = 120;
    let aspectRatio = cvs.width / cvs.height;
    cvs.style.width = window.innerHeight * aspectRatio + "px";
    cvs.style.height = window.innerHeight + "px";
    let ctx = cvs.getContext("2d");

    document.getElementById("chatbox").style.visibility = "hidden";

    main = new Main(ctx);
    main.initialize();
    cvs.addEventListener('mousedown', function (event) {
      cvs.requestPointerLock();
    });
  };

  window.onresize = function(){
    let aspectRatio = cvs.width / cvs.height;
    cvs.style.width = window.innerHeight * aspectRatio + "px";
    cvs.style.height = window.innerHeight + "px";
  };

  document.addEventListener('keydown', function(event) {
    main.handleKeyDown(event.keyCode);
  });

  document.addEventListener('keyup', function (event) {
    main.handleKeyUp(event.keyCode);
  });

  document.addEventListener('mouseup', function (event) {
    if (main != undefined) 
      main.handleMouseUp()
  });

  document.addEventListener('mousemove', function (event) {
    if (main != undefined)
      main.handleMouseMove(event.movementX);
  });
</script>